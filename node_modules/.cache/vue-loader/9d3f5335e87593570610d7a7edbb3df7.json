{"remainingRequest":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\src\\views\\HeritageRanking.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\src\\views\\HeritageRanking.vue","mtime":1640443243529},{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\css-loader\\dist\\cjs.js","mtime":1637922544066},{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1637922548447},{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\postcss-loader\\src\\index.js","mtime":1637922545893},{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1637922542348},{"path":"D:\\a-my-html\\html-GIS\\git-develop\\vue-industry-gis\\node_modules\\vue-loader\\lib\\index.js","mtime":1637922546721}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5oZXJpdGFnZS1yYW5raW5nIC5lbC10YWItcGFuZSB7DQogIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQp9DQouaGVyaXRhZ2UtcmFua2luZyAjbWFpbjEsDQouaGVyaXRhZ2UtcmFua2luZyAjbWFpbnRocmVlLA0KLmhlcml0YWdlLXJhbmtpbmcgI21haW5mb3VyIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogNTUwcHg7DQogIG1hcmdpbjogMCBhdXRvOw0KfQ0KDQouaGVyaXRhZ2UtcmFua2luZyAubWFpbnR3byB7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDU1MHB4Ow0KICBtYXJnaW46IDAgYXV0bzsNCn0NCg0KLmhlcml0YWdlLXJhbmtpbmcgLmxvYWRpbmcgew0KICB3aWR0aDogODBweDsNCiAgaGVpZ2h0OiBhdXRvOw0KICBtYXJnaW46IDAgYXV0bzsNCiAgcGFkZGluZzogMjAwcHggMDsNCn0NCg=="},{"version":3,"sources":["HeritageRanking.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAidA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"HeritageRanking.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <!-- 遗产排行榜 -->\r\n  <div class=\"heritage-ranking\">\r\n    <div class=\"heritage-ranking-top\">\r\n      <MainTop>遗产数据 <span class=\"gang\"> / </span> 数据可视化</MainTop>\r\n    </div>\r\n    <div class=\"heritage-ranking-bottom padding15\">\r\n      <el-button-group>\r\n        <el-button @click=\"changeType('one')\" icon=\"el-icon-data-analysis\"\r\n          >各年限遗产数量分布榜</el-button\r\n        >\r\n        <el-button @click=\"changeType('four')\" icon=\"el-icon-s-data\"\r\n          >工业遗产旅游热度排行榜</el-button\r\n        >\r\n        <el-button @click=\"changeType('three')\" icon=\"el-icon-notebook-1\"\r\n          >遗产详细分类汇总</el-button\r\n        >\r\n        <el-button @click=\"changeType('two')\" icon=\"el-icon-pie-chart\"\r\n          >工业遗产各分类占比</el-button\r\n        >\r\n        <el-button\r\n          @click=\"changeType('help')\"\r\n          icon=\"el-icon-thumb\r\n\"\r\n          >查看帮助</el-button\r\n        >\r\n      </el-button-group>\r\n      <br />\r\n      <br />\r\n\r\n      <el-card shadow=\"hover\">\r\n        <div class=\"loading\" v-show=\"!dataisok\">\r\n          <img\r\n            src=\"\r\nhttps://vkceyugu.cdn.bspapp.com/VKCEYUGU-790d5b85-9674-4a89-9bcc-c0657ea369be/83aff900-03ef-4380-86c1-d452e085589f.gif\"\r\n            alt=\"\"\r\n          />\r\n        </div>\r\n        <!-- 建议使用v-show来代替 v-if，否者容易出现不可预见的错误 -->\r\n        <div v-show=\"rankType === 'one' && dataisok\" id=\"main1\"></div>\r\n        <div v-show=\"rankType === 'two' && dataisok\" class=\"maintwo\"></div>\r\n        <div v-show=\"rankType === 'three' && dataisok\" id=\"mainthree\"></div>\r\n        <div v-show=\"rankType === 'four' && dataisok\" id=\"mainfour\"></div>\r\n\r\n        <div v-if=\"rankType === 'help' && dataisok\">\r\n          可视化图表操作简介：\r\n          <br />\r\n          <br />\r\n          <span\r\n            >1、在拥有图例的图表点击对应图例可以将该图例所指示的数据暂时隐藏</span\r\n          >\r\n          <el-divider></el-divider>\r\n          <span>2、讲鼠标移动到对应数据上可以查看数据详情</span>\r\n          <el-divider></el-divider>\r\n          <span>3、在图表右上方的操作栏可以查看图表的数据视图</span\r\n          ><el-divider></el-divider>\r\n          <span>4、在图表右上方的操作栏可以将图表导出为图片</span>\r\n        </div>\r\n      </el-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as echarts from \"echarts/core\";\r\nimport { BarChart, PieChart } from \"echarts/charts\";\r\nimport {\r\n  TitleComponent,\r\n  TooltipComponent,\r\n  GridComponent,\r\n  LegendComponent,\r\n  ToolboxComponent,\r\n} from \"echarts/components\";\r\nimport { CanvasRenderer } from \"echarts/renderers\";\r\necharts.use([\r\n  TitleComponent,\r\n  TooltipComponent,\r\n  GridComponent,\r\n  LegendComponent,\r\n  ToolboxComponent,\r\n\r\n  BarChart,\r\n  PieChart,\r\n  CanvasRenderer, // 渲染器的注册应当写到后面，数组是有顺序的。\r\n]);\r\nimport MainTop from \"../components/MainTop.vue\";\r\nexport default {\r\n  components: {\r\n    MainTop,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      mainData: [], //所有遗产数据\r\n      rankType: \"one\", //当前所展示的图表\r\n      option: null,\r\n      myChart: null,\r\n      hertige1949: [0, 0, 0],\r\n      hertige2000: [0, 0, 0],\r\n      hertige2000later: [0, 0, 0], //图一绘图数据\r\n      dataisok: false,\r\n      heritageType: [], //图4绘图数据\r\n      allType: [],\r\n    };\r\n  },\r\n\r\n  created() {\r\n    this.getDatas();\r\n  },\r\n\r\n  methods: {\r\n    async getDatas() {\r\n      var res1 = await this.$axios.get(\r\n        \"/getHeritageMainData/getHeritageMainData\"\r\n      );\r\n      this.mainData.push(...res1.data.data);\r\n\r\n      var res2 = await this.$axios.get(\"/getHeritageMuseum/getHeritageMuseum\");\r\n      this.mainData.push(...res2.data.data);\r\n\r\n      var res3 = await this.$axios.get(\r\n        \"/getHeritageTourism/getHeritageTourism\"\r\n      );\r\n      this.mainData.push(...res3.data.data);\r\n\r\n      // 处理图1数据start\r\n\r\n      for (let i = 0; i < this.mainData.length; i++) {\r\n        if (this.mainData[i].addType === \"工业遗产\") {\r\n          if (this.mainData[i].start < 1949) {\r\n            this.hertige1949[0] = this.hertige1949[0] + 1;\r\n          } else if (\r\n            this.mainData[i].start >= 1949 &&\r\n            this.mainData[i].start < 2000\r\n          ) {\r\n            this.hertige2000[0] = this.hertige2000[0] + 1;\r\n          } else {\r\n            this.hertige2000later[0] = this.hertige2000later[0] + 1;\r\n          }\r\n        } else if (this.mainData[i].addType === \"遗产博物馆\") {\r\n          if (this.mainData[i].start < 1949) {\r\n            this.hertige1949[1] = this.hertige1949[1] + 1;\r\n          } else if (\r\n            this.mainData[i].start >= 1949 &&\r\n            this.mainData[i].start < 2000\r\n          ) {\r\n            this.hertige2000[1] = this.hertige2000[1] + 1;\r\n          } else {\r\n            this.hertige2000later[1] = this.hertige2000later[1] + 1;\r\n          }\r\n        } else if (this.mainData[i].addType === \"工业旅游区\") {\r\n          if (this.mainData[i].start < 1949) {\r\n            this.hertige1949[2] = this.hertige1949[2] + 1;\r\n          } else if (\r\n            this.mainData[i].start >= 1949 &&\r\n            this.mainData[i].start < 2000\r\n          ) {\r\n            this.hertige2000[2] = this.hertige2000[2] + 1;\r\n            // console.log(this.mainData[i]);\r\n          } else {\r\n            this.hertige2000later[2] = this.hertige2000later[2] + 1;\r\n          }\r\n        }\r\n      }\r\n      this.dataisok = true;\r\n      // 处理图1数据end\r\n      // 处理图4数据start\r\n      this.heritageType[0] = {\r\n        value:\r\n          this.hertige1949[0] + this.hertige2000[0] + this.hertige2000later[0],\r\n        name: \"工业遗产遗址\",\r\n      };\r\n      this.heritageType[1] = {\r\n        value:\r\n          this.hertige1949[1] + this.hertige2000[1] + this.hertige2000later[1],\r\n        name: \"遗产博物馆\",\r\n      };\r\n      this.heritageType[2] = {\r\n        value:\r\n          this.hertige1949[2] + this.hertige2000[2] + this.hertige2000later[2],\r\n        name: \"工业旅游区\",\r\n      };\r\n      // 处理图4数据end\r\n      // var year1Data = res1.data.data.sort((a, b) => a.start - b.start);\r\n      // // console.log(\"year1\", year1Data);\r\n      //处理图3start\r\n\r\n      //处理图3end\r\n\r\n      // console.log(\r\n      //   \"1\",\r\n      //   this.hertige1949,\r\n      //   \"2\",\r\n      //   this.hertige2000,\r\n      //   \"3\",\r\n      //   this.hertige2000later\r\n      // );\r\n\r\n      this.mainData.forEach((ele) => {\r\n        // console.log(ele);\r\n        var index = this.allType.findIndex((che) => che.name === ele.type);\r\n        if (index === -1) {\r\n          this.allType.push({\r\n            value: 1,\r\n            name: ele.type,\r\n          });\r\n        } else {\r\n          this.allType[index].value = this.allType[index].value + 1;\r\n        }\r\n        // console.log(\"all type\", this.allType);\r\n      });\r\n\r\n      this.allType.sort((a, b) => b.value - a.value);\r\n    },\r\n    // 切换当前状态\r\n    changeType(type) {\r\n      this.rankType = type;\r\n      // console.log(this.rankType);\r\n\r\n      setTimeout(() => {\r\n        if (type === \"one\") {\r\n          this.drawOne();\r\n        }\r\n        if (type === \"two\") {\r\n          this.drawTwo();\r\n        }\r\n        if (type === \"three\") {\r\n          this.drawThree();\r\n        }\r\n        if (type === \"four\") {\r\n          this.drawFour();\r\n        }\r\n      }, 0);\r\n    },\r\n\r\n    drawOne() {\r\n      var chartDom = document.getElementById(\"main1\");\r\n      var myChart = echarts.init(chartDom);\r\n      var option;\r\n      // console.log(this.hertige1949);\r\n\r\n      option = {\r\n        toolbox: {\r\n          show: true,\r\n          feature: {\r\n            mark: { show: true },\r\n            dataView: { show: true, readOnly: false },\r\n            restore: { show: true },\r\n            saveAsImage: { show: true },\r\n          },\r\n        },\r\n        title: {\r\n          text: \"各年限遗产数量分布榜\",\r\n        },\r\n        tooltip: {\r\n          trigger: \"axis\",\r\n          axisPointer: {\r\n            type: \"shadow\",\r\n          },\r\n        },\r\n        legend: {},\r\n        grid: {\r\n          left: \"3%\",\r\n          right: \"4%\",\r\n          bottom: \"3%\",\r\n          containLabel: true,\r\n        },\r\n        xAxis: {\r\n          type: \"value\",\r\n          boundaryGap: [0, 0.01],\r\n        },\r\n        yAxis: {\r\n          type: \"category\",\r\n          data: [\"工业遗产\", \"遗产博物馆\", \"工业旅游区\"],\r\n        },\r\n        series: [\r\n          {\r\n            name: \"1949前\",\r\n            type: \"bar\",\r\n            data: this.hertige1949,\r\n          },\r\n          {\r\n            name: \"1949~2000\",\r\n            type: \"bar\",\r\n            data: this.hertige2000,\r\n          },\r\n          {\r\n            name: \"2000后\",\r\n            type: \"bar\",\r\n            data: this.hertige2000later,\r\n          },\r\n        ],\r\n      };\r\n\r\n      option && myChart.setOption(option);\r\n    },\r\n\r\n    drawTwo() {\r\n      var chartDom = document.querySelector(\".maintwo\");\r\n      var myChart = echarts.init(chartDom);\r\n\r\n      var option = {\r\n        toolbox: {\r\n          show: true,\r\n          feature: {\r\n            mark: { show: true },\r\n            dataView: { show: true, readOnly: false },\r\n            restore: { show: true },\r\n            saveAsImage: { show: true },\r\n          },\r\n        },\r\n        title: {\r\n          text: \"各类工业遗产分类占比\",\r\n          subtext: \"整体分类\",\r\n          left: \"center\",\r\n        },\r\n        tooltip: {\r\n          trigger: \"item\",\r\n        },\r\n        legend: {\r\n          orient: \"vertical\",\r\n          left: \"left\",\r\n        },\r\n        series: [\r\n          {\r\n            name: \"该分类总数量\",\r\n            type: \"pie\",\r\n            radius: \"50%\",\r\n            data: this.heritageType,\r\n            emphasis: {\r\n              itemStyle: {\r\n                shadowBlur: 10,\r\n                shadowOffsetX: 0,\r\n                shadowColor: \"rgba(0, 0, 0, 0.5)\",\r\n              },\r\n            },\r\n          },\r\n        ],\r\n      };\r\n\r\n      option && myChart.setOption(option);\r\n    },\r\n    drawThree() {\r\n      var chartDom = document.getElementById(\"mainthree\");\r\n      var myChart = echarts.init(chartDom);\r\n      var option;\r\n\r\n      option = {\r\n        title: {\r\n          text: \"工业遗产详细分类数据汇总\",\r\n        },\r\n        tooltip: {\r\n          trigger: \"item\",\r\n          formatter: \"{a} <br/>{b} : {c} ({d}%)\",\r\n        },\r\n        legend: {\r\n          top: \"bottom\",\r\n        },\r\n        toolbox: {\r\n          show: true,\r\n          feature: {\r\n            mark: { show: true },\r\n            dataView: { show: true, readOnly: false },\r\n            restore: { show: true },\r\n            saveAsImage: { show: true },\r\n          },\r\n        },\r\n        series: [\r\n          {\r\n            name: \"该类型遗产数目\",\r\n            type: \"pie\",\r\n            radius: [50, 250],\r\n            center: [\"50%\", \"50%\"],\r\n            roseType: \"area\",\r\n            itemStyle: {\r\n              borderRadius: 8,\r\n            },\r\n            label: {\r\n              show: false,\r\n            },\r\n\r\n            data: this.allType,\r\n          },\r\n        ],\r\n      };\r\n\r\n      option && myChart.setOption(option);\r\n    },\r\n\r\n    drawFour() {\r\n      var chartDom = document.getElementById(\"mainfour\");\r\n      var myChart = echarts.init(chartDom);\r\n      var option;\r\n\r\n      option = {\r\n        toolbox: {\r\n          show: true,\r\n          feature: {\r\n            mark: { show: true },\r\n            dataView: { show: true, readOnly: false },\r\n            restore: { show: true },\r\n            saveAsImage: { show: true },\r\n          },\r\n        },\r\n        title: {\r\n          text: \"工业遗产旅游热度排行榜(人次)\",\r\n        },\r\n        xAxis: {\r\n          data: [\r\n            \"食草堂小镇\",\r\n            \"开滦矿山公园\",\r\n            \"启新产业园\",\r\n            \"和道创意小镇\",\r\n            \"刘伶醉景区\",\r\n            \"铁路源头博物馆\",\r\n            \"林西矿遗址\",\r\n            \"唐胥铁路遗址\",\r\n          ],\r\n        },\r\n        yAxis: {\r\n          type: \"value\",\r\n        },\r\n        series: [\r\n          {\r\n            data: [\r\n              {\r\n                value: 8321,\r\n                itemStyle: {\r\n                  color: \"#a90000\",\r\n                },\r\n              },\r\n              6742,\r\n              5931,\r\n              5028,\r\n              4321,\r\n              4178,\r\n              3002,\r\n              2814,\r\n            ],\r\n            type: \"bar\",\r\n            showBackground: true,\r\n            backgroundStyle: {\r\n              color: \"rgba(180, 180, 180, 0.2)\",\r\n            },\r\n          },\r\n        ],\r\n      };\r\n\r\n      option && myChart.setOption(option);\r\n    },\r\n  },\r\n\r\n  // 表格数据是动态的，需要动态获取\r\n  updated() {\r\n    // 处理数据\r\n    // console.log(\"1,=\", this.mainData);\r\n    if (this.rankType === \"one\") {\r\n      // console.log(\"draw one\");\r\n      this.drawOne();\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.heritage-ranking .el-tab-pane {\r\n  width: 100% !important;\r\n}\r\n.heritage-ranking #main1,\r\n.heritage-ranking #mainthree,\r\n.heritage-ranking #mainfour {\r\n  width: 100%;\r\n  height: 550px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.heritage-ranking .maintwo {\r\n  width: 100%;\r\n  height: 550px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.heritage-ranking .loading {\r\n  width: 80px;\r\n  height: auto;\r\n  margin: 0 auto;\r\n  padding: 200px 0;\r\n}\r\n</style>"]}]}