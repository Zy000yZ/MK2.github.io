{"remainingRequest":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\src\\views\\DataList.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\src\\views\\DataList.vue","mtime":1745829662543},{"path":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code Files\\VueFile\\大同市煤炭资源信息管理系统0.1\\webgis-miandata1.1\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgRXhjZWxKUyBmcm9tICdleGNlbGpzJzsNCmltcG9ydCB7IHNhdmVBcyB9IGZyb20gJ2ZpbGUtc2F2ZXInOw0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7fSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgdGFibGVEYXRhOiBbXSwNCiAgICAgIG1haW5EYXRhOiBbXSwNCg0KICAgICAgZGlhbG9nRm9ybVZpc2libGU6IGZhbHNlLA0KICAgICAgZm9ybTogew0KICAgICAgICB1c2VybmFtZTogIiIsDQogICAgICAgIHBhc3N3b3JkOiAiIiwNCiAgICAgICAgcGhvbmU6ICIiLA0KICAgICAgICBsaWNlbnNlUGxhdGU6IFtdLA0KICAgICAgfSwNCiAgICAgIGZvcm1MYWJlbFdpZHRoOiAiMTIwcHgiLA0KDQogICAgICBqcU1haW46IHsNCiAgICAgICAgbmFtZTogIuWQjOeFpOWkp+WUkOWhlOWxseeFpOefv+aciemZkOWFrOWPuOWhlOWxseefvyIsDQogICAgICAgIGNraWQ6ICJDMTAwMDAwMjAwOTA0MTEyMDAxNDY1MSIsDQogICAgICAgIGppbmc6IDExMy4wOTA2ODUsDQogICAgICAgIHdlaTogMzkuOTM2Mzk1LA0KICAgICAgICBkYWlkOiAiMTQzMjAxMDE2LTAwNSIsDQogICAgICAgIGNvbXBhbnk6ICLmmYvog73mjqfogqHnhaTkuJrpm4blm6LmnInpmZDlhazlj7giLA0KICAgICAgICBudW06IDI1MDAsDQogICAgICAgIHR5cGU6ICLlubPnoZDlvIDmi5MiLA0KICAgICAgICBqdG51bTogOSwNCiAgICAgICAgc2N0eXBlOiAi57u86YeH5pS+6aG254WkIiwNCiAgICAgICAgbGV2OiAi6auY55Om5pavIiwNCiAgICAgICAgZGFuZ2VybGV2OiAi6Ieq54eDIiwNCiAgICAgICAgbm93OiAi5q2j5Zyo5byA6YeHIiwNCiAgICAgIH0sDQoNCiAgICAgIHNlYXJjaFN0cjogIiIsDQogICAgfTsNCiAgfSwNCg0KICBhc3luYyBjcmVhdGVkKCkgew0KICAgIHRoaXMuZ2V0RGF0YSgpOw0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBnZXREYXRhKCkgew0KICAgICAgdmFyIHJlcyA9IGF3YWl0IHRoaXMuJGF4aW9zLmdldCgNCiAgICAgICAgIi9EYVRvbmdNZWlUYW5NYXJrZXJHZXQvRGFUb25nTWVpVGFuTWFya2VyR2V0Ig0KICAgICAgKTsNCiAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzLmRhdGEuZGF0YTsNCiAgICAgIHRoaXMubWFpbkRhdGEgPSByZXMuZGF0YS5kYXRhOw0KICAgICAgY29uc29sZS5sb2codGhpcy51c2VyTGlzdCk7DQogICAgfSwNCg0KICAgIC8vIDIwMjQwMzA0IOa3u+WKoOS/oeaBrw0KICAgIGFkZFRybERhdGEoKSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL0hlcml0YWdlUHJvUHVzaC9hZGQiKTsNCiAgICB9LA0KDQogICAgLy8g5qih57OK5p+l6K+i5oyJ6ZKuDQogICAgc2VhcmNoQ2xpY2soKSB7DQogICAgICB0aGlzLnRhYmxlRGF0YSA9IHRoaXMubWFpbkRhdGE7DQogICAgICBpZiAodGhpcy5zZWFyY2hTdHIpIHsNCiAgICAgICAgdGhpcy50YWJsZURhdGEgPSB0aGlzLm1haW5EYXRhLmZpbHRlcigoZWxlKSA9Pg0KICAgICAgICAgIGVsZS5uYW1lLmluY2x1ZGVzKHRoaXMuc2VhcmNoU3RyKQ0KICAgICAgICApOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBnZXRNYWluKGUpIHsNCiAgICAgIHRoaXMuanFNYWluID0gZTsNCiAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSB0cnVlOw0KICAgIH0sDQoNCiAgICBhc3luYyBkZWxNYWluKGUpIHsNCiAgICAgIHZhciByZXMgPSBudWxsOw0KICAgICAgcmVzID0gYXdhaXQgdGhpcy4kYXhpb3MucG9zdCgNCiAgICAgICAgIi9EYVRvbmdNZWlUYW5NYXJrZXJSZW1vdmUvRGFUb25nTWVpVGFuTWFya2VyUmVtb3ZlIiwNCiAgICAgICAgew0KICAgICAgICAgIF9pZDogZS5faWQsDQogICAgICAgIH0NCiAgICAgICk7DQogICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7DQogICAgICAgIHRoaXMuZ2V0RGF0YSgpOw0KICAgICAgfQ0KICAgIH0sDQogICAgZWRpdFBhcmsoZSkgew0KICAgICAgY29uc29sZS5sb2coZSk7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL01lYXN1cmVMaXN0Iik7DQogICAgfSwNCg0KDQoNCiAgIGFzeW5jIGRvd25MaXN0KCkgew0KICAgICBjb25zdCB3b3JrYm9vayA9IG5ldyBFeGNlbEpTLldvcmtib29rKCk7DQogIGNvbnN0IHdvcmtzaGVldCA9IHdvcmtib29rLmFkZFdvcmtzaGVldCgnU2hlZXQxJyk7DQogIA0KICAvLyDmt7vliqDooajlpLQNCiAgd29ya3NoZWV0LmNvbHVtbnMgPSBbDQogICAgeyBoZWFkZXI6ICfkvIHkuJrlkI3np7AnLCBrZXk6ICduYW1lJyB9LA0KICAgIHsgaGVhZGVyOiAn6YeH55+/6K645Y+v6K+BJywga2V5OiAnY2tpZCcgfSwNCiAgICB7IGhlYWRlcjogJ+aho+ahiOe8luWPtycsIGtleTogJ2RhaWQnIH0sDQogICAgeyBoZWFkZXI6ICfpmrblsZ7kvIHkuJonLCBrZXk6ICdjb21wYW55JyB9LA0KICAgIHsgaGVhZGVyOiAn55Sf5oiQ6IO95Yqb77yI5LiH5ZCoL+W5tO+8iScsIGtleTogJ251bScgfSwNCiAgICB7IGhlYWRlcjogJ+W8gOaLk+aWueW8jycsIGtleTogJ3R5cGUnIH0sDQogICAgeyBoZWFkZXI6ICflnZDmoIfnu4/luqYnLCBrZXk6ICdqaW5nJyB9LA0KICAgIHsgaGVhZGVyOiAn5Z2Q5qCH57qs5bqmJywga2V5OiAnd2VpJyB9LA0KICAgIHsgaGVhZGVyOiAn5LqV562S5pWw6YePJywga2V5OiAnanRudW0nIH0sDQogICAgeyBoZWFkZXI6ICfph4fnhaTlt6XoibonLCBrZXk6ICdzY3R5cGUnIH0sDQogICAgeyBoZWFkZXI6ICfnk6bmlq/nrYnnuqcnLCBrZXk6ICdsZXYnIH0sDQogICAgeyBoZWFkZXI6ICfoh6rnh4PlgL7lkJHmgKcnLCBrZXk6ICdkYW5nZXJsZXYnIH0sDQogICAgeyBoZWFkZXI6ICflvIDph4fnirbmgIEnLCBrZXk6ICdub3cnIH0sDQogIF07DQogIA0KICAvLyDmt7vliqDmlbDmja4NCmZvcihsZXQgaT0wO2k8dGhpcy5tYWluRGF0YS5sZW5ndGg7aSsrKXsNCiAgd29ya3NoZWV0LmFkZFJvdyh0aGlzLm1haW5EYXRhW2ldKTsNCg0KfQ0KDQogIC8vIOeUn+aIkOaWh+S7tg0KICBjb25zdCBidWZmZXIgPSBhd2FpdCB3b3JrYm9vay54bHN4LndyaXRlQnVmZmVyKCk7DQogIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbYnVmZmVyXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXQnIH0pOw0KICBzYXZlQXMoYmxvYiwgJ+Wkp+WQjOW4gueFpOeCrei1hOa6kOS/oeaBr+ihqC54bHN4Jyk7DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["DataList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DataList.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"user-data-manage\">\r\n    <div class=\"mani\">\r\n      <el-button size=\"small\" type=\"info\" @click=\"downList\"\r\n        >下载导出煤炭资源数据表至本地</el-button\r\n      >\r\n\r\n      <el-button size=\"small\" type=\"info\" @click=\"addTrlData\"\r\n        >添加煤炭资源</el-button\r\n      >\r\n\r\n      <el-input\r\n        style=\"width: 300px; margin-left: 15px\"\r\n        placeholder=\"请输入企业名称关键词进行属性查询\"\r\n        v-model=\"searchStr\"\r\n        size=\"small\"\r\n        class=\"input-with-select\"\r\n      >\r\n        <el-button\r\n          slot=\"append\"\r\n          icon=\"el-icon-search\"\r\n          @click=\"searchClick\"\r\n        ></el-button>\r\n      </el-input>\r\n      <br />\r\n      <br />\r\n      <el-table :data=\"tableData\" border style=\"width: 100%\" height=\"470\">\r\n        <el-table-column fixed type=\"index\" label=\"序号\" width=\"80\">\r\n        </el-table-column>\r\n        <el-table-column fixed prop=\"name\" label=\"企业名称\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"ckid\" label=\"采矿许可证编号\" width=\"120\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"jing\" label=\"坐标经度\" width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"wei\" label=\"坐标纬度\" width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"daid\" label=\"档案编号\"> </el-table-column>\r\n        <el-table-column prop=\"company\" label=\"隶属企业\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"num\" label=\"生产能力（万吨/年）\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"type\" label=\"开拓方式\"> </el-table-column>\r\n        <el-table-column prop=\"jtnum\" label=\"井筒数量/个\"> </el-table-column>\r\n        <el-table-column prop=\"sctype\" label=\"采煤工艺\"> </el-table-column>\r\n        <el-table-column prop=\"lev\" label=\"瓦斯等级\"> </el-table-column>\r\n        <el-table-column prop=\"dangerlev\" label=\"自燃倾向性\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"now\" label=\"开采状态\"> </el-table-column>\r\n\r\n        <el-table-column label=\"操作\" align=\"center\" width=\"300\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button type=\"text\" size=\"small\" @click=\"getMain(scope.row)\"\r\n              >查看</el-button\r\n            >\r\n            <el-button\r\n              style=\"color: red\"\r\n              type=\"text\"\r\n              size=\"small\"\r\n              @click=\"delMain(scope.row)\"\r\n              >删除</el-button\r\n            >\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n\r\n    <el-dialog :title=\"jqMain.name\" :visible.sync=\"dialogFormVisible\">\r\n      <p style=\"padding-bottom: 6px\">采矿许可证编号：{{ jqMain.ckid }}</p>\r\n      <p style=\"padding-bottom: 6px\">档案编号：{{ jqMain.daid }}</p>\r\n      <p style=\"padding-bottom: 6px\">隶属企业：{{ jqMain.company }}</p>\r\n      <p style=\"padding-bottom: 6px\">生产能力（万吨/年）：{{ jqMain.num }}</p>\r\n      <p style=\"padding-bottom: 6px\">开拓方式：{{ jqMain.type }}</p>\r\n      <p style=\"padding-bottom: 6px\">井筒数量：{{ jqMain.jtnum }}个</p>\r\n      <p style=\"padding-bottom: 6px\">采煤工艺：{{ jqMain.sctype }}</p>\r\n      <p style=\"padding-bottom: 6px\">瓦斯等级：{{ jqMain.lev }}</p>\r\n      <p style=\"padding-bottom: 6px\">自燃倾向性：{{ jqMain.dangerlev }}</p>\r\n      <p style=\"padding-bottom: 6px\">开采状态：{{ jqMain.now }}</p>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ExcelJS from 'exceljs';\r\nimport { saveAs } from 'file-saver';\r\nexport default {\r\n  components: {},\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      mainData: [],\r\n\r\n      dialogFormVisible: false,\r\n      form: {\r\n        username: \"\",\r\n        password: \"\",\r\n        phone: \"\",\r\n        licensePlate: [],\r\n      },\r\n      formLabelWidth: \"120px\",\r\n\r\n      jqMain: {\r\n        name: \"同煤大唐塔山煤矿有限公司塔山矿\",\r\n        ckid: \"C1000002009041120014651\",\r\n        jing: 113.090685,\r\n        wei: 39.936395,\r\n        daid: \"143201016-005\",\r\n        company: \"晋能控股煤业集团有限公司\",\r\n        num: 2500,\r\n        type: \"平硐开拓\",\r\n        jtnum: 9,\r\n        sctype: \"综采放顶煤\",\r\n        lev: \"高瓦斯\",\r\n        dangerlev: \"自燃\",\r\n        now: \"正在开采\",\r\n      },\r\n\r\n      searchStr: \"\",\r\n    };\r\n  },\r\n\r\n  async created() {\r\n    this.getData();\r\n  },\r\n\r\n  methods: {\r\n    async getData() {\r\n      var res = await this.$axios.get(\r\n        \"/DaTongMeiTanMarkerGet/DaTongMeiTanMarkerGet\"\r\n      );\r\n      this.tableData = res.data.data;\r\n      this.mainData = res.data.data;\r\n      console.log(this.userList);\r\n    },\r\n\r\n    // 20240304 添加信息\r\n    addTrlData() {\r\n      this.$router.push(\"/HeritageProPush/add\");\r\n    },\r\n\r\n    // 模糊查询按钮\r\n    searchClick() {\r\n      this.tableData = this.mainData;\r\n      if (this.searchStr) {\r\n        this.tableData = this.mainData.filter((ele) =>\r\n          ele.name.includes(this.searchStr)\r\n        );\r\n      }\r\n    },\r\n\r\n    getMain(e) {\r\n      this.jqMain = e;\r\n      this.dialogFormVisible = true;\r\n    },\r\n\r\n    async delMain(e) {\r\n      var res = null;\r\n      res = await this.$axios.post(\r\n        \"/DaTongMeiTanMarkerRemove/DaTongMeiTanMarkerRemove\",\r\n        {\r\n          _id: e._id,\r\n        }\r\n      );\r\n      if (res.status === 200) {\r\n        this.getData();\r\n      }\r\n    },\r\n    editPark(e) {\r\n      console.log(e);\r\n      this.$router.push(\"/MeasureList\");\r\n    },\r\n\r\n\r\n\r\n   async downList() {\r\n     const workbook = new ExcelJS.Workbook();\r\n  const worksheet = workbook.addWorksheet('Sheet1');\r\n  \r\n  // 添加表头\r\n  worksheet.columns = [\r\n    { header: '企业名称', key: 'name' },\r\n    { header: '采矿许可证', key: 'ckid' },\r\n    { header: '档案编号', key: 'daid' },\r\n    { header: '隶属企业', key: 'company' },\r\n    { header: '生成能力（万吨/年）', key: 'num' },\r\n    { header: '开拓方式', key: 'type' },\r\n    { header: '坐标经度', key: 'jing' },\r\n    { header: '坐标纬度', key: 'wei' },\r\n    { header: '井筒数量', key: 'jtnum' },\r\n    { header: '采煤工艺', key: 'sctype' },\r\n    { header: '瓦斯等级', key: 'lev' },\r\n    { header: '自燃倾向性', key: 'dangerlev' },\r\n    { header: '开采状态', key: 'now' },\r\n  ];\r\n  \r\n  // 添加数据\r\nfor(let i=0;i<this.mainData.length;i++){\r\n  worksheet.addRow(this.mainData[i]);\r\n\r\n}\r\n\r\n  // 生成文件\r\n  const buffer = await workbook.xlsx.writeBuffer();\r\n  const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\r\n  saveAs(blob, '大同市煤炭资源信息表.xlsx');\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.user-data-manage .mani {\r\n  padding: 15px;\r\n}\r\n</style>\r\n"]}]}